!function t(e,n,o){function i(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var p=n[s]={exports:{}};e[s][0].call(p.exports,function(t){var n=e[s][1][t];return i(n?n:t)},p,p.exports,t,e,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(t,e,n){var o,i,r,s,a,c;r=$("#user-auth"),i=r.find('input[name="email"]'),a=r.find('input[name="password"]'),o=$("#user-auth-button"),s=$("body").data("home"),c=function(){var t;return t=/^([a-z0-9_\.-])+@[a-z0-9-]+\.([a-z]{2,4}\.)?[a-z]{2,4}$/i,t.test(i.val())?""!==a.val()?$.ajax(s+"/api/user/auth",{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:{email:i.val(),password:a.val()}}).done(function(t){return"mismatch"===t?$.alert("Логин пользователя или пароль не совпадают."):location.href=t}):a.blink():i.blink()},o.click(c),r.keypress(function(t){return 13===t.which?c():void 0})},{}],2:[function(t,e,n){Array.prototype.have=function(t){return-1===this.indexOf(t)?!1:!0},Array.prototype.remove=function(t){return this.splice(this.indexOf(t),1)},Array.prototype["in"]=function(t){var e,n,o;for(n=0,o=this.length;o>n;n++)if(e=this[n],e.id===t)return!0;return!1},Array.prototype.last=function(){return this[this.length-1]},String.prototype.excerpt=function(){var t;return t=this.indexOf("."),this.slice(0,t+1)},$.fn.blink=function(){return this.stop(!0).animate({backgroundColor:"#f3df6d"},300,function(){return $(this).stop(!0).animate({backgroundColor:"white"},300)})},$.fn.preload=function(t){return"start"===t&&(this.data("text",this.html()),this.html(""),this.addClass("preloader-start")),"stop"===t&&(this.removeClass("preloader-start"),this.addClass("preloader-end")),"reset"===t?(this.removeClass("preloader-end"),this.removeClass("preloader-start"),this.html(this.data("text"))):void 0},$(".sticky").stick_in_parent({offset_top:5}),$.alert=function(t,e){return $.magnificPopup.open({type:"inline",closeBtnInside:!0,items:{src:"#alert-popup"},callbacks:{open:function(){var e;return e=this.content.children(".popup_content"),e.prepend("<p class='alert-message'>"+t+"</p>"),e.find(".popup_button").click(function(t){return function(){return $.magnificPopup.instance.close()}}(this))},close:function(){return this.content.children(".popup_content").children(".alert-message").html(""),e?location.reload():void 0}}})},$.HandlebarsFactory=function(t){return $(t).get(0)?Handlebars.compile($(t).html()):function(){}}},{}],3:[function(t,e,n){var o,i,r,s,a,c=function(t,e){function n(){this.constructor=t}for(var o in e)u.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},u={}.hasOwnProperty,p=function(t,e){return function(){return t.apply(e,arguments)}};r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.defaults={address:"",about:"",excerpt:"",logo:"",name:"",phone:"",tags:[]},e}(Backbone.Model),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.model=r,e}(Backbone.Collection),s=function(t){function e(){return this.render=p(this.render,this),e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.className="company-preview",e.prototype.popup=$("#company-main-popup"),e.prototype.popupTemplate=$.HandlebarsFactory("#company-template"),e.prototype.template=$.HandlebarsFactory("#company-preview-template"),e.prototype.initialize=function(){var t;return t=$.parseHTML(this.popupTemplate({logo:this.model.get("logo"),name:this.model.get("name"),about:this.model.get("about"),address:this.model.get("address"),phone:this.model.get("phone"),tags:this.model.get("tags")})),this.$el.magnificPopup({type:"inline",closeBtnInside:!0,items:{src:"#company-main-popup"},callbacks:{open:function(e){return function(){return e.popup.append(t),e.popup.find(".company-popup_close").click(function(){return $.magnificPopup.instance.close()})}}(this),close:function(t){return function(){return t.popup.html("")}}(this)}})},e.prototype.render=function(){return this.$el.html(this.template({logo:this.model.get("logo"),address:this.model.get("address"),excerpt:this.model.get("excerpt"),name:this.model.get("name")})),this.$el},e.prototype.fillModel=function(){},e}(Backbone.View),i=function(t){function e(){return this.updateCollection=p(this.updateCollection,this),this.showMore=p(this.showMore,this),e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.home=$("body").data("home"),e.prototype.data={spec:0,make:0,skip:5},e.prototype.showMoreBtn=$("#show-more-found-companies"),e.prototype.initialize=function(){return this.data.make=this.$el.data("make"),this.url="api/get-companies-by-make",this.$el.data("spec")&&(this.data.spec=this.$el.data("spec"),this.url="api/get-companies-by-make-and-spec"),this.collection=new o,this.fillCollection(),this.showMoreBtn?this.showMoreBtn.click(this.showMore):void 0},e.prototype.fillCollection=function(){return this.$el.children(".company-preview").each(function(t){return function(e,n){var o,i,a;return i=[],$(n).children(".company-preview_data").children("div").each(function(t,e){return i.push($(e).data("tag"))}),o=new r({logo:$(n).children(".company-preview_logo").css("background-image"),address:$(n).find(".company-preview_address").html(),name:$(n).find(".company-preview_name").html(),excerpt:$(n).find(".company-preview_excerpt").html(),phone:$(n).children(".company-preview_data").data("phone"),about:$(n).children(".company-preview_data").data("about"),tags:i}),a=new s({model:o,el:n}),a.fillModel(),t.collection.add(o)}}(this))},e.prototype.showMore=function(){return this.get()},e.prototype.get=function(){return $.ajax(this.home+"/"+this.url,{data:this.data}).done(function(t){return function(e){return t.updateCollection(e),t.skip+=5}}(this))},e.prototype.updateCollection=function(t){var e,n,o,i,s;for(console.log(t),t.length<=5&&this.showMoreBtn.hide(),n=o=0,i=t.length;i>o;n=++o)e=t[n],5>n&&(s=new r({address:e.address,about:e.about,excerpt:e.about.excerpt(),logo:"url("+e.logo+")",name:e.name,phone:e.phone,tags:e.tags}),this.collection.add(s));return this.render()},e.prototype.render=function(){return this.$el.html(""),this.collection.each(function(t){return function(e){var n;return n=new s({model:e}),t.$el.append(n.render())}}(this))},e}(Backbone.View),a=new i({el:"#catalog-companies"})},{}],4:[function(t,e,n){var o,i,r,s,a,c,u,p,l,h,d=function(t,e){function n(){this.constructor=t}for(var o in e)f.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f={}.hasOwnProperty,m=function(t,e){return function(){return t.apply(e,arguments)}};u=t("../inc/TypeList"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.defaults={id:0,type:null},e}(Backbone.Model),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.model=s,e.prototype.active=!0,e}(Backbone.Collection),a=function(t){function e(){return this.show=m(this.show,this),this.hide=m(this.hide,this),e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.initialize=function(){return this.model.on("hide",this.hide),this.model.on("show",this.show)},e.prototype.hide=function(){return this.$el.css("display","none")},e.prototype.show=function(){return this.$el.css("display","block")},e}(Backbone.View),r=function(t){function e(){return this.showIfActive=m(this.showIfActive,this),this.changed=m(this.changed,this),e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.home=$("body").data("home"),e.prototype.active=0,e.prototype.empty=$(".makes_empty"),e.prototype.initialize=function(){var t,e,n,o,r,s,a;if(0!==this.$el.length){for(a=this,this.deps={},this.collection=new i,this.options.types.on("changed",this.changed),this.fillCollection(),r=this.options.types.$el.children(),s=[],t=e=0,n=r.length;n>e;t=++e)o=r[t],t+=1,s.push(function(t){return setTimeout(function(){return a.get(t)},1e3)}(t));return s}},e.prototype.fillCollection=function(){return this.$el.find("li").each(function(t){return function(e,n){var o,i;return o=new s({id:$(n).data("id")}),t.collection.add(o),i=new a({model:o,el:n})}}(this))},e.prototype.changed=function(t){return 0===t?(this.reset(),this.active=0):void 0===this.deps[t]?this.active=t:this.updateCollection(t)},e.prototype.updateCollection=function(t){return 0===this.deps[t].length?this.empty.show():this.empty.hide(),this.collection.each(function(e){return function(n){return e.deps[t].have(n.get("id"))?n.trigger("show"):n.trigger("hide")}}(this))},e.prototype.reset=function(){return this.empty.hide(),this.collection.each(function(t){return t.trigger("show")})},e.prototype.showIfActive=function(t){return 0!==this.active&&this.active===t?this.changed(this.active):void 0},e}(Backbone.View),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.url="api/get-makes-by-type-has-comps",e.prototype.get=function(t){return $.ajax(this.home+"/"+this.url,{data:{id:t}}).done(function(e){return function(n){var o,i,r;for(e.deps[t]=[],o=0,i=n.length;i>o;o++)r=n[o],r.type=t,e.deps[t].push(r.id);return e.showIfActive(t)}}(this))},e}(r),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.url="api/get-makes-by-spec-type",e.prototype.get=function(t){return $.ajax(this.home+"/"+this.url,{data:{type:t,spec:this.$el.data("current")}}).done(function(e){return function(n){return e.deps[t]=n,e.showIfActive(t)}}(this))},e}(r),h=new u({el:"#types"}),p=new o({el:"#catalog-makes",types:h}),l=new c({el:"#catalog-specmakes",types:h}),h.click(),$("#type").on("change",function(){return console.log($(".type_item--active"))})},{"../inc/TypeList":15}],5:[function(t,e,n){var o,i,r,s,a=function(t,e){function n(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty,u=function(t,e){return function(){return t.apply(e,arguments)}};o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults={name:"",date:"",content:""},e}(Backbone.Model),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model=o,e}(Backbone.Collection),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.template=$.HandlebarsFactory("#comment-template"),e.prototype.className="comment",e.prototype.initialize=function(){return this.render()},e.prototype.render=function(){return this.$el.html(this.template({name:this.model.get("name"),ava:this.model.get("ava"),date:this.model.get("date"),content:this.model.get("content")}))},e}(Backbone.View),new(r=function(t){function e(){return this.addComment=u(this.addComment,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.collection=new s,e.prototype.home=$("body").data("home"),e.prototype.initialize=function(){return this.fillCollection(),this.setAuthDefaults(),this.id=this.$el.data("feedback"),this.button=$("#comments-button"),this.textarea=$("#comments-textarea"),this.button.click(this.addComment),this.textarea.click(function(t){return function(){return t.button.css("display","flex")}}(this)),this.textarea.blur(function(t){return function(){return""===t.textarea.val()?t.button.hide():void 0}}(this))},e.prototype.fillCollection=function(){return this.$el.find(".comment").each(function(t){return function(e,n){var r,s;return r=new o({name:$.trim($(n).find(".comment_name").html()),date:$.trim($(n).find(".comment_date").html()),content:$.trim($(n).find(".comment_content").html()),ava:$(n).find(".comment_ava").data("ava")}),t.collection.add(r),s=new i({el:n,model:r})}}(this))},e.prototype.setAuthDefaults=function(){return this.name=$("#comments-send").data("name"),this.ava=this.home+"/"+$("#comments-send").data("ava")},e.prototype.addComment=function(){var t,e,n;return""===this.textarea.val()?void this.textarea.blink():(t=new Date,e=t.getDate()+"."+(t.getMonth()+1)+"."+t.getFullYear(),n=new o({name:this.name,ava:this.ava,content:this.textarea.val(),date:e}),this.collection.add(n),this.renderCollection(),this.send(n))},e.prototype.renderCollection=function(){var t;return t=$(".comments_block"),t.html(""),this.collection.each(function(e){var n;return n=new i({model:e}),t.append(n.el)}),this.textarea.val(""),this.textarea.blur()},e.prototype.send=function(t){return $.ajax(this.home+"/api/comments/create",{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:{comment:t.get("content"),feedback:this.id}}).done(function(t){return console.log(t)})},e}(Backbone.View))({el:"#comments"})},{}],6:[function(t,e,n){var o,i,r,s,a,c,u,p,l=function(t,e){function n(){this.constructor=t}for(var o in e)h.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},h={}.hasOwnProperty,d=function(t,e){return function(){return t.apply(e,arguments)}};p=t("./inc/Thumbnails"),o=t("./inc/ImageReader"),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e}(Backbone.Model),u=function(t){function e(){return this.doAnswer=d(this.doAnswer,this),e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.url="api/response/create",e.prototype.home=$("body").data("home"),e.prototype.initialize=function(){return this.roomId=this.options.roomId,this.text=this.$el.find(".response_textarea"),this.answer=this.$el.find(".response_answer"),this.body=this.$el.find(".response_body"),this.thumbnails=this.options.thumbnails,this.answer.click(this.doAnswer)},e.prototype.doAnswer=function(){return""!==this.text.val()?(this.text.hide(),this.answer.hide(),this.body.html(this.text.val()),this.sendResponse()):void 0},e.prototype.sendResponse=function(){return $.ajax(this.home+"/"+this.url,{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:{room:this.roomId,response:this.text.val(),photos:this.thumbnails.get()}}).done(function(t){return function(t){return console.log(t)}}(this))},e}(Backbone.View),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.defaults={id:0},e}(Backbone.Model),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.initialize=function(){var t;return t=new p({el:$("#response-photos"),plus:$("#response-plus"),reader:new o("#response-photos-input")}),new u({el:this.$el.children(".response"),roomId:this.model.get("id"),thumbnails:t})},e}(Backbone.View),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.model=i,e}(Backbone.Collection),new(a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.initialize=function(){return this.collection=new s,this.initRequests()},e.prototype.initRequests=function(){return this.$el.children(".requests_item").each(function(t){return function(e,n){var o,s;return o=new i({id:$(n).data("id")}),t.collection.add(o),s=new r({el:n,model:o})}}(this))},e}(Backbone.View))({el:"#company-requests"})},{"./inc/ImageReader":12,"./inc/Thumbnails":14}],7:[function(t,e,n){var o,i,r=function(t,e){return function(){return t.apply(e,arguments)}};i=t("./inc/Validator"),new(o=function(){function t(t,e,n){this.name=t,this.email=e,this.text=n,this.send=r(this.send,this),this.button=$("#contacts-submit"),this.button.click(this.send)}return t.prototype.home=$("body").data("home"),t.prototype.url="api/contacts/send",t.prototype.send=function(){var t,e;return t={name:this.name,email:this.email,text:this.text},e=new i(t),e.fails?void 0:(this.button.preload("start"),$.ajax(this.home+"/"+this.url,{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:{name:this.name.val(),email:this.email.val(),text:this.text.val()}}).done(function(t){return function(e){return t.button.preload("stop"),$.alert("Мы получили Ваше сообщение и ответим на него в порядке очереди"),t.button.preload("reset"),t.name.val(""),t.email.val(""),t.text.val("")}}(this)))},t}())($("#contacts-name"),$("#contacts-email"),$("#contacts-text"))},{"./inc/Validator":16}],8:[function(t,e,n){var o,i,r,s,a,c=function(t,e){function n(){this.constructor=t}for(var o in e)u.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},u={}.hasOwnProperty,p=function(t,e){return function(){return t.apply(e,arguments)}};a=t("./ModelsList"),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.defaults={id:0,title:"",visible:!0},e}(Backbone.Model),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.model=o,e.prototype.resetVisible=function(){return this.each(function(t){return t.set("visible",!0)})},e}(Backbone.Collection),s=function(t){function e(){return this.destroy=p(this.destroy,this),this.selectChanged=p(this.selectChanged,this),e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.template=$.HandlebarsFactory("#create-company-make-template"),e.prototype.className="create-company_makes-models_item",e.prototype.initialize=function(){return this.makes=new r(this.options.makes),this.render(),this.$el.find(".create-company_make").children(".popup_redx").click(function(t){return function(){return t.destroy()}}(this)),this.select=this.$el.find(".create-company_make").children("select"),this.select.change(this.selectChanged),this.modelslist=new a({el:this.$el.children(".create-company_models"),typeId:parseInt(this.select.val())})},e.prototype.selectChanged=function(t){return this.modelslist.update(parseInt(t.target.value)),this.trigger("selectChanged",t.target.value,this)},e.prototype.destroy=function(){return this.trigger("destroy",this),this.remove()},e.prototype.updateOptions=function(t){var e;return e=parseInt(this.select.val()),this.select.children().remove(),t.each(function(t){return function(n){var o;return o=$('<option class="popup_option"></option>'),o.val(n.get("id")),o.html(n.get("title")),(e===parseInt(o.val())||n.get("visible"))&&t.select.append(o),e===parseInt(o.val())?o.attr("selected","selected"):void 0}}(this)),this.select.selectBox("refresh")},e.prototype.initSelectbox=function(){return this.select.selectBox()},e.prototype.render=function(){return this.$el.html(this.template({makes:this.makes.toJSON()}))},e}(Backbone.View),i=function(t){function e(){return this.getMakes=p(this.getMakes,this),this.typeUpdated=p(this.typeUpdated,this),this.updateMakesCollection=p(this.updateMakesCollection,this),this.destroyMakesList=p(this.destroyMakesList,this),this.add=p(this.add,this),e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.home=$("body").data("home"),e.prototype.url="api/get-makes-by-type",e.prototype.makesCollection=new r,e.prototype.makesListArray=[],e.prototype.active=!1,e.prototype.initialize=function(){return this.options.types.on("changed",this.typeUpdated),this.$el.find(".popup_plus-sign:first").click(this.add)},e.prototype.add=function(){var t;if(!this.active)return void this.options.types.error();if(0!==this.makesCollection.where({visible:!0}).length)return t=new s({makes:this.makesCollection.where({visible:!0})}),this.makesListArray.push(t),t.on("destroy",this.destroyMakesList),t.on("selectChanged",this.updateMakesCollection),this.renderAddMakesList(),this.updateMakesCollection()},e.prototype.destroyMakesList=function(t){return this.makesListArray.remove(t),this.updateMakesCollection()},e.prototype.updateMakesCollection=function(){var t,e,n,o,i,r,s,a,c;for(this.makesCollection.resetVisible(),s=this.makesListArray,t=0,n=s.length;n>t;t++)i=s[t],r=this.makesCollection.get(i.select.val()),r.set("visible",!1);for(a=this.makesListArray,c=[],e=0,o=a.length;o>e;e++)i=a[e],c.push(i.updateOptions(this.makesCollection));return c},e.prototype.typeUpdated=function(t){return this.reset(),this.getMakes(t)},e.prototype.reset=function(){var t,e,n,o;for(this.makesCollection.reset(),o=this.makesListArray,t=0,e=o.length;e>t;t++)n=o[t],n.remove();return this.makesListArray=[]},e.prototype.getMakes=function(t){return $.ajax(this.home+"/"+this.url,{data:{id:t}}).done(function(t){return function(e){return t.makesCollection.add(e),t.active=!0,t.add()}}(this))},e.prototype.renderAddMakesList=function(){var t;return t=this.makesListArray.last(),this.$el.append(t.el),t.initSelectbox()},e.prototype.get=function(){var t,e,n,o,i,r;for(r=[],i=this.makesListArray,t=0,e=i.length;e>t;t++)n=i[t],o={},o.id=parseInt(n.select.val()),o.models=n.modelslist.get(),r.push(o);return r},e}(Backbone.View),e.exports=i},{"./ModelsList":9}],9:[function(t,e,n){var o,i,r,s,a=function(t,e){function n(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty,u=function(t,e){return function(){return t.apply(e,arguments)}};o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults={id:0,title:"",visible:!0},e}(Backbone.Model),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model=o,e.prototype.resetVisible=function(){return this.each(function(t){return t.set("visible",!0)})},e}(Backbone.Collection),i=function(t){function e(){return this.destroy=u(this.destroy,this),this.selectChanged=u(this.selectChanged,this),this.initSelectbox=u(this.initSelectbox,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.template=$.HandlebarsFactory("#create-company-model-template"),e.prototype.className="create-company_model popup_field",e.prototype.initialize=function(){return this.models=new r(this.options.models),this.render(),this.$el.children(".popup_redx").click(function(t){return function(){return t.destroy()}}(this)),this.select=this.$el.children("select"),this.select.change(this.selectChanged)},e.prototype.initSelectbox=function(){return this.select.selectBox()},e.prototype.selectChanged=function(t){return this.trigger("selectChanged",t.target.value,this)},e.prototype.updateOptions=function(t){var e;return e=parseInt(this.select.val()),this.select.children().remove(),t.each(function(t){return function(n){var o;return o=$('<option class="popup_option"></option>'),o.val(n.get("id")),o.html(n.get("title")),(e===parseInt(o.val())||n.get("visible"))&&t.select.append(o),e===parseInt(o.val())?o.attr("selected","selected"):void 0}}(this)),this.select.selectBox("refresh")},e.prototype.destroy=function(){return this.trigger("destroy",this),this.remove()},e.prototype.render=function(){return this.$el.html(this.template({models:this.models.toJSON()}))},e}(Backbone.View),s=function(t){function e(){return this.destroy=u(this.destroy,this),this.updateModelsCollection=u(this.updateModelsCollection,this),this.destroyMakesList=u(this.destroyMakesList,this),this.add=u(this.add,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.template=$.HandlebarsFactory("#create-company-models-list-template"),e.prototype.home=$("body").data("home"),e.prototype.url="api/get-models-by-make",e.prototype.initialize=function(){return this.modelsCollection=new r,this.modelsArray=[],this.typeId=this.options.typeId,this.getModels(),this.render(),this.$el.find(".popup_plus-sign").click(this.add)},e.prototype.add=function(){var t;if(0!==this.modelsCollection.where({visible:!0}).length)return t=new i({models:this.modelsCollection.where({visible:!0})}),this.modelsArray.push(t),this.renderAddModel(),this.updateModelsCollection(),t.on("destroy",this.destroyMakesList),t.on("selectChanged",this.updateModelsCollection)},e.prototype.destroyMakesList=function(t){return this.modelsArray.remove(t),this.updateModelsCollection()},e.prototype.updateModelsCollection=function(){var t,e,n,o,i,r,s,a,c;for(this.modelsCollection.resetVisible(),s=this.modelsArray,t=0,n=s.length;n>t;t++)r=s[t],i=this.modelsCollection.get(r.select.val()),i.set("visible",!1);for(a=this.modelsArray,c=[],e=0,o=a.length;o>e;e++)r=a[e],c.push(r.updateOptions(this.modelsCollection));return c},e.prototype.update=function(t){var e,n,o,i;for(this.typeId=t,this.modelsCollection.reset(),i=this.modelsArray,e=0,n=i.length;n>e;e++)o=i[e],o.remove();return this.modelsArray=[],this.getModels()},e.prototype.getModels=function(){return $.ajax(this.home+"/"+this.url,{data:{id:this.typeId}}).done(function(t){return function(e){return t.modelsCollection.add(e)}}(this))},e.prototype.destroy=function(){return this.remove()},e.prototype.render=function(){return this.$el.append(this.$el.html(this.template))},e.prototype.renderAddModel=function(){var t;return t=this.modelsArray.last(),this.$el.append(t.el),t.initSelectbox()},e.prototype.get=function(){var t,e,n,o,i;if(i=[],0===this.modelsArray.length)return 0;for(o=this.modelsArray,t=0,e=o.length;e>t;t++)n=o[t],i.push(parseInt(n.select.val()));return i},e}(Backbone.View),e.exports=s},{}],10:[function(t,e,n){var o,i=function(t,e){return function(){return t.apply(e,arguments)}};o=function(){function t(t,e,n){var o;this.url=n,this.send=i(this.send,this),o=this,this.coords={},this.id=$(t),this.input=$(e),this.popup=$("#avatar-popup"),this.template=$.HandlebarsFactory("#avatar-template"),this.id.click(function(t){return function(){return t.input.click()}}(this)),this.input.change(function(){return o.readFile(this.files)})}return t.prototype.home=$("body").data("home"),t.prototype.readFile=function(t){var e,n;return e=t[0],-1===e.type.search("image")?void alert("это не картинка"):(n=new FileReader,n.onloadend=function(t){return function(){var e;return e=n.result,t.src=e,t.showPopup(e)}}(this),n.readAsDataURL(e))},t.prototype.adjustPopup=function(t){return t.naturalWidth>780?this.popup.css("width","780px"):t.naturalWidth>300?this.popup.css("width",t.naturalWidth+"px"):this.popup.css("width","300px")},t.prototype.showErrorPopup=function(){return this.popup.html('<span class="popup_error">Картинка должна быть не меньше 115px и не больше 7000px по ширине и высоте</span>'),this.input.val(""),$.magnificPopup.open({items:{src:this.popup}})},t.prototype.showPopup=function(t){var e;return this.popup.html(this.template({src:t})),e=this.popup.find("img"),e.load(function(t){return function(){var n,o;return e[0].naturalHeight<115||e[0].naturalHeight>7e3?void t.showErrorPopup():e[0].naturalWidth<115||e[0].naturalWidth>7e3?void t.showErrorPopup():(t.adjustPopup(e[0]),o=e[0].naturalWidth,n=e[0].naturalHeight,e.Jcrop({aspectRatio:1,minSize:[115,115],boxWidth:780,boxHeight:$(document).height()-300,setSelect:[.25*o,.07*n,.75*o,.75*n],onSelect:function(e){return t.coords={x:e.x,y:e.y,w:e.w,h:e.h}}}),$.magnificPopup.open({items:{src:t.popup},closeOnBgClick:!1,callbacks:{open:function(){return t.button=t.popup.find(".popup_button"),t.button.click(t.send)},close:function(){return t.input.val("")}}}))}}(this))},t.prototype.updateAva=function(t){return this.id.children("img").attr("src",t)},t.prototype.send=function(){var t;return t=$.magnificPopup.instance.st.closeOnBgClick=!0,this.button.preload("start"),$.ajax(this.home+"/"+this.url,{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:{src:this.src,coords:this.coords}}).done(function(t){return function(e){return setTimeout(function(){return t.updateAva(e)},800),t.button.preload("stop"),setTimeout(function(){return $.magnificPopup.instance.close(),location.reload()},1e3)}}(this))},t}(),e.exports=o},{}],11:[function(t,e,n){var o,i,r,s,a=function(t,e){function n(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty,u=function(t,e){return function(){return t.apply(e,arguments)}};i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults={value:"",newvalue:"",name:"",title:"",state:"same",elToRefresh:""},e}(Backbone.Model),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model=i,e}(Backbone.Collection),s=function(t){function e(){return this.error=u(this.error,this),this.update=u(this.update,this),this.updateModel=u(this.updateModel,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="popup_field",e.prototype.template=$.HandlebarsFactory("#popup-field-template"),e.prototype.initialize=function(){return this.render(),this.model.on("error",this.error),this.model.on("update",this.update),"about"===this.model.get("name")?this.input=this.$el.children("textarea"):this.input=this.$el.children("input"),""===this.input.val()&&this.model.set("state","empty"),this.input.keyup(this.updateModel)},e.prototype.updateModel=function(){return this.model.set("newvalue",this.input.val()),this.model.get("value")===this.model.get("newvalue")?this.model.set("state","same"):""===this.model.get("newvalue")?this.model.set("state","empty"):this.model.set("state","ready")},e.prototype.update=function(){var t;return t=this.model.get("elToRefresh"),""!==this.model.get("newvalue")&&this.model.set("value",this.model.get("newvalue")),this.model.set("state","same"),t.html(this.model.get("value"))},e.prototype.error=function(){return this.$el.children("input, textarea").blink()},e.prototype.render=function(){return this.model.get("value")?this.$el.html(this.template({label:this.model.get("title"),value:this.model.get("value"),input:"about"===this.model.get("name")?!1:!0})):this.$el.html(this.template({label:this.model.get("title"),input:"about"===this.model.get("name")?!1:!0})),this.$el},e}(Backbone.View),r=function(t){function e(){return this.saveChanges=u(this.saveChanges,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.home=$("body").data("home"),e.prototype.initialize=function(){return this.collection=new o(this.collection),this.button=this.options.button,this.url=this.options.url,this.render(),this.button.click(this.saveChanges)},e.prototype.saveChanges=function(){var t,e;return e=!0,t={},this.collection.each(function(n){return"empty"===n.get("state")?(n.trigger("error"),e=!1):""!==n.get("newvalue")?t[n.get("name")]=n.get("newvalue"):void 0}),e?this.post(t):void 0},e.prototype.updateModels=function(){return this.collection.each(function(t){return t.trigger("update")})},e.prototype.post=function(t){return this.button.preload("start"),$.ajax(this.home+"/"+this.url,{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:t}).done(function(t){return function(e){return console.log(e),t.button.preload("stop"),t.updateModels(),setTimeout(function(){return $.magnificPopup.instance.close(),location.reload()},1e3)}}(this))},e.prototype.render=function(){return this.collection.each(function(t){return function(e){var n;return n=new s({model:e}),t.button.before(n.el)}}(this))},e}(Backbone.View),e.exports=r},{}],12:[function(t,e,n){var o,i=function(t,e){return function(){return t.apply(e,arguments)}};o=function(){function t(t){this.check=i(this.check,this);var e;e=this,_.extend(this,Backbone.Events),this.input=$(t),this.filesResults=[],this.input.change(function(){return e.check(this.files)})}return t.prototype.check=function(t){var e,n,o,i,r;for(r=[],n=o=0,i=t.length;i>o;n=++o)e=t[n],-1!==e.type.search("image")&&r.push(this.read(e));return Promise.all(r).then(function(t){return function(e){return t.trigger("read",e)}}(this))},t.prototype.read=function(t){return new Promise(function(e,n){var o,i;return i="",o=new FileReader,o.onloadend=function(t){return function(){return e(o.result)}}(this),o.readAsDataURL(t)})},t}(),e.exports=o},{}],13:[function(t,e,n){var o,i=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);
return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty;o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.home=$("body").data("home"),e.prototype.initialize=function(){return this.$el.selectBox()},e.prototype.events={change:"selected"},e.prototype.selected=function(){return this.options.c&&this.options.c.reset(),this.options.c&&(this.options.c.options.parent=this),this.options.c?this.options.c.store(this.$el.val()):void 0},e.prototype.reset=function(){return this.$el.find("option:not(:first)").remove(),this.$el.selectBox("refresh"),this.options.c?this.options.c.reset():void 0},e.prototype.error=function(){return this.$el.selectBox("control").blink()},e.prototype.render=function(){var t,e,n;return n=$.HandlebarsFactory("#options-template"),e=n(this.options.json),t=$.parseHTML(e),this.$el.find("option:first").after(t),this.$el.selectBox("refresh")},e.prototype.store=function(t){var e;return e=this,$.ajax(this.home+"/"+this.options.url,{data:{id:t}}).done(function(t){var n,o,i,r,s;if("undefined"!=typeof e.options.type){for(console.log(t),s=e.options.parent.options.parent.$el.val(),n=o=0,r=t.length;r>o;n=++o)i=t[n],parseInt(n.type,10!==parseInt(s,10))&&t.splice(i,1);console.log(t)}return e.options.json=t,e.render()})},e.prototype.get=function(){return this.$el.val()},e}(Backbone.View),e.exports=o},{}],14:[function(t,e,n){var o,i,r,s,a=function(t,e){function n(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty,u=function(t,e){return function(){return t.apply(e,arguments)}};o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults={src:""},e}(Backbone.Model),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model=o,e}(Backbone.Collection),r=function(t){function e(){return this.destroy=u(this.destroy,this),this.clean=u(this.clean,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="feedback_photo",e.prototype.template=$.HandlebarsFactory("#photos-template"),e.prototype.initialize=function(){var t;return t=this,this.model.on("clean",this.clean),this.render(),this.$el.find(".popup_redx:first").click(function(){return t.destroy()})},e.prototype.clean=function(){return this.$el.remove()},e.prototype.destroy=function(){return this.model.destroy(),this.clean()},e.prototype.render=function(){return this.$el.html(this.template({src:this.model.get("src")}))},e}(Backbone.View),s=function(t){function e(){return this.added=u(this.added,this),this.fillCollection=u(this.fillCollection,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.collection=new i,e.prototype.initialize=function(){return this.collection.on("add",this.added),this.plus=this.options.plus,this.reader=this.options.reader,this.reader.on("read",this.fillCollection),this.plus.click(function(t){return function(){return t.reader.input.click()}}(this))},e.prototype.fillCollection=function(t){var e,n,o,i,r;for(i=[],e=n=0,o=t.length;o>n&&(r=t[e],10!==e);e=++n)i.push(this.collection.add({src:r}));return i},e.prototype.added=function(t){return this.clean(),this.render()},e.prototype.clean=function(){return this.collection.each(function(t){return function(t){return t.trigger("clean")}}(this))},e.prototype.render=function(){return this.collection.each(function(t){return function(e){var n;return n=new r({model:e}),t.plus.before(n.el)}}(this))},e.prototype.get=function(){var t;return t=[],this.collection.each(function(e){return t.push(e.get("src"))}),t},e}(Backbone.View),e.exports=s},{}],15:[function(t,e,n){var o,i,r,s,a=function(t,e){function n(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty,u=function(t,e){return function(){return t.apply(e,arguments)}};i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults={id:0,name:null},e}(Backbone.Model),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model=i,e}(Backbone.Collection),r=function(t){function e(){return this.deactivate=u(this.deactivate,this),this.activate=u(this.activate,this),this.changeState=u(this.changeState,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.initialize=function(){return this["class"]="type_item--active",this.model.on("deactivate",this.deactivate),this.model.on("click",this.activate),this.state=!1},e.prototype.events={click:"changeState"},e.prototype.changeState=function(){return this.state?(this.deactivate(),this.model.trigger("pass")):this.activate()},e.prototype.activate=function(){return $("#catalog-makes").find("a").each(function(t){return function(e,n){return n.href=n.href.replace("/make/","/make/"+t.model.attributes.name+"/")}}(this)),$("#catalog-specmakes").find("a").each(function(t){return function(e,n){return n.href=n.href.replace(/catalog\/(.*)\//,"catalog/$1"+t.model.attributes.name+"/")}}(this)),this.model.trigger("activate",this.model),this.$el.addClass(this["class"]),this.state=!0},e.prototype.deactivate=function(){return this.$el.removeClass(this["class"]),$("#catalog-makes").find("a").each(function(t){return function(e,n){return n.href=n.href.replace(t.model.attributes.name+"/","")}}(this)),$("#catalog-specmakes").find("a").each(function(t){return function(e,n){return console.log(n.href),n.href=n.href.replace(t.model.attributes.name,"")}}(this)),this.state=!1},e}(Backbone.View),o=function(t){function e(){return this.pass=u(this.pass,this),this.deactivate=u(this.deactivate,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.initialize=function(){return this.activeId=0,this.collection=new s,this.collection.on("activate",this.deactivate),this.collection.on("pass",this.pass),this.fillCollection()},e.prototype.fillCollection=function(){return this.$el.children("li").each(function(t){return function(e,n){var o,s,a,c;return o=$(n).data("id"),a=$(n).data("name"),s=new i({id:o,name:a}),c=new r({model:s,el:n}),t.collection.add(s)}}(this))},e.prototype.deactivate=function(t){return this.activeId=t.get("id"),this.collection.each(function(e){return function(e){return e!==t?e.trigger("deactivate"):void 0}}(this)),this.trigger("changed",this.activeId)},e.prototype.pass=function(){return this.activeId=0,this.trigger("changed",this.activeId)},e.prototype.click=function(){return 0!==this.collection.length?this.collection.at(0).trigger("click"):void 0},e}(Backbone.View),e.exports=o},{}],16:[function(t,e,n){var o;o=function(){function t(t){this.elements=t,this.fails=!1,this.check()}return t.prototype.check=function(){var t,e,n;n=this.elements;for(e in n)if(t=n[e],""===t.val())return t.blink(),void(this.fails=!0)},t}(),e.exports=o},{}],17:[function(t,e,n){t("./base"),t("./popups/index"),t("./catalog/catalog-live"),t("./catalog/catalog-companies"),t("./auth"),t("./profile"),t("./mention"),t("./logout"),t("./company-requests"),t("./user-requests"),t("./comments"),t("./contacts")},{"./auth":1,"./base":2,"./catalog/catalog-companies":3,"./catalog/catalog-live":4,"./comments":5,"./company-requests":6,"./contacts":7,"./logout":18,"./mention":19,"./popups/index":22,"./profile":26,"./user-requests":27}],18:[function(t,e,n){var o,i;i=$("#user-logout-form"),o=$("#user-logout-button"),o.click(function(){return i.submit()})},{}],19:[function(t,e,n){var o,i,r,s,a,c=function(t,e){return function(){return t.apply(e,arguments)}};a=$("#mention_photos"),a.photosetGrid({gutter:"3px",highresLinks:!0,onComplete:function(){return a.find("a").magnificPopup({type:"image",closeBtnInside:!1,gallery:{enabled:!0}})}}),o=function(){function t(t,e,n){this.el=t,this.elInfo=e,this["class"]=n,this.send=c(this.send,this),this.minus=c(this.minus,this),this.plus=c(this.plus,this),this.toggle=c(this.toggle,this),this.pass=c(this.pass,this),this.span=this.el.children("span"),this.count=this.el.data("count"),this.active=this.el.data("active"),this.active&&this.el.addClass(this["class"]),this.el.click(this.pass)}return t.prototype.home=$("body").data("home"),t.prototype.id=$(".mention_rate:first").data("id"),t.prototype.url="api/feedback/vote",t.prototype.pass=function(){return this.click(this)},t.prototype.updateInfo=function(){return this.elInfo.html(this.count)},t.prototype.toggle=function(){return this.active?(this.minus(),this.active=0,this.el.removeClass(this["class"])):(this.plus(),this.active=1,this.el.addClass(this["class"])),this.updateInfo()},t.prototype.plus=function(){return this.span.html(++this.count)},t.prototype.minus=function(){return this.span.html(--this.count)},t.prototype.send=function(t){return $.ajax(this.home+"/"+this.url,{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:{id:this.id,type:t}}).done(function(t){return function(t){return console.log(t)}}(this)).error(function(){return console.log("error")})},t}(),i=function(){function t(t,e){this.likes=t,this.dislikes=e,this.dislikesClick=c(this.dislikesClick,this),this.likesClick=c(this.likesClick,this),this.likes.click=this.likesClick,this.dislikes.click=this.dislikesClick}return t.prototype.likesClick=function(t){return t.toggle(),this.dislikes.active&&this.dislikes.toggle(),t.send("likes")},t.prototype.dislikesClick=function(t){return t.toggle(),this.likes.active&&this.likes.toggle(),t.send("dislikes")},t}(),s=new o($("#mention-likes"),$("#mention-likes-info"),"mention_likes--active"),r=new o($("#mention-dislikes"),$("#mention-dislikes-info"),"mention_dislikes--active"),new i(s,r)},{}],20:[function(t,e,n){var o,i,r,s,a,c,u,p,l,h,d,f,m,y,g,v,_,k,b=function(t,e){return function(){return t.apply(e,arguments)}},w=function(t,e){function n(){this.constructor=t}for(var o in e)C.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},C={}.hasOwnProperty;a=t("../inc/SelectView"),i=t("../create-company/MakesList"),$("#create-company-button").magnificPopup({type:"inline",closeBtnInside:!0}),v=$("#create-company-spec"),v.selectBox(),m=$("#create-company-name"),u=$("#create-company-address"),y=$("#create-company-phone"),c=$("#create-company-about"),d=$("#create-company-logo-label"),d.css("padding","10px"),d.css("margin-bottom","0"),autosize(c),o=function(){function t(t,e,n){this.check=b(this.check,this);var o;o=this,this.btn=$(t),this.input=$(e),this.container=$(n),this.input.change(function(){return o.check(this.files)}),this.src="",this.btn.click(function(){return o.input.click()})}return t.prototype.check=function(t){var e;return e=t[0],-1===e.type.search("image")?this.error():this.read(e)},t.prototype.error=function(){return alert("это не картинка")},t.prototype.append=function(t){var e;return this.container.html(""),e=new Image,e.src=t,console.log(e),this.container.html(e)},t.prototype.get=function(){return this.src},t.prototype.read=function(t){var e,n;return n="",e=new FileReader,e.onloadend=function(t){return function(){return n=e.result,t.src=n,t.append(n)}}(this),e.readAsDataURL(t)},t}(),h=new o("#create-company-logo-btn","#create-company-logo","#create-company-logo-html"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.initialize=function(){var t;return t=this,this.$el.selectBox(),this.$el.change(function(){return t.trigger("changed",$(this).val())})},e.prototype.error=function(){return this.$el.selectBox("control").blink()},e.prototype.get=function(){return this.$el.val()},e}(Backbone.View),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.initialize=function(){var t;return t=this,this.$el.selectBox(),this.$el.change(function(){return t.trigger("changed",$(this).val())})},e.prototype.error=function(){return this.$el.selectBox("control").blink()},e.prototype.get=function(){return this.$el.val()},e}(Backbone.View),k=new s({el:"#create-company-type"}),p=new r({el:"#create-company-ctype"}),f=new i({el:"#create-company_makes-models",types:k}),_=$("#create-company-submit"),l=$("#company-signup-auth"),g=$("#sign-up-company-check"),_.click(function(){var t,e,n,o,i;if(o={},null==k.get())return void k.error();if(o.type=parseInt(k.get()),null==p.get())return void p.error();if(o.cType=parseInt(p.get()),null==v.val())return void v.selectBox("control").blink();if(o.spec=parseInt(v.val()),o.makesmodels=f.get(),""===m.val())return void m.blink();if(o.name=m.val(),""===u.val())return void u.blink();if(o.address=u.val(),""===y.val())return void y.blink();if(o.phone=y.val(),""===c.val())return void c.blink();if(o.about=c.val(),""===h.get())return void d.blink();if(o.logo=h.get(),i="api/company/create",l.length){if(g.prop("checked")!==!0)return;if(i="api/company/create-signup",t=l.find(".company-signup-email"),e=l.find(".company-signup-pass"),""===t.val())return void t.blink();if(o.email=t.val(),""===e.val())return void e.blink();if(o.pass=e.val(),n=/^([a-z0-9_\.-])+@[a-z0-9-]+\.([a-z]{2,4}\.)?[a-z]{2,4}$/i,!n.test(t.val()))return void t.blink()}return $(this).preload("start"),$.ajax($("body").data("home")+"/"+i,{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:o}).done(function(t){return function(e){return console.log(e),$(t).preload("stop"),l.length?-1!==e.search("http")?location.href=e:($.magnificPopup.instance.close(),$.alert("Пользователь с таким логином уже существует.")):setTimeout(function(){return $.magnificPopup.instance.close(),$.alert("Ваша компания добавлена и ожидает проверки.")},1e3)}}(this))})},{"../create-company/MakesList":8,"../inc/SelectView":13}],21:[function(t,e,n){var o,i,r,s,a,c,u,p,l,h,d,f,m,y,g=function(t,e){function n(){this.constructor=t}for(var o in e)v.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},v={}.hasOwnProperty,_=function(t,e){return function(){return t.apply(e,arguments)}};c=t("../inc/SelectView"),o=t("../inc/ImageReader"),u=t("../inc/Thumbnails"),$("#feedback").magnificPopup({type:"inline",closeBtnInside:!0}),h=new c({el:"#feedback-model",url:"api/get-models-by-make",type:0}),p=new c({el:"#feedback-make",c:h,url:"api/get-makes-by-type"}),y=new c({el:"#feedback-type",c:p}),m=new u({el:$("#feedback-photos"),plus:$("#feedback-plus"),reader:new o("#feedback-input")}),0!==$("#feedback-editor").length&&(f=new Quill("#feedback-editor",{theme:"snow"}),f.addModule("toolbar",{container:"#feedback-editor-toolbar"})),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.defaults={text:""},e}(Backbone.Model),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.model=s,e}(Backbone.Collection),a=function(t){function e(){return this.clean=_(this.clean,this),this.error=_(this.error,this),e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.template=$.HandlebarsFactory("#plus-minus-template"),e.prototype.initialize=function(){var t;return t=this,this.render(),this.model.on("clean",this.clean),this.model.on("error",this.error),this.$el.find(".popup_redx").click(function(t){return function(){return t.destroy()}}(this)),this.$el.children("input").keyup(function(){return t.model.set("text",$(this).val())})},e.prototype.error=function(){return this.$el.children("input").blink()},e.prototype.render=function(){return this.$el.html(this.template({text:this.model.get("text")}))},e.prototype.destroy=function(){return this.model.destroy(),this.clean()},e.prototype.clean=function(){return this.$el.remove()},e}(Backbone.View),i=function(t){function e(){return this.add=_(this.add,this),e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.initialize=function(){return this.options.add.on("click",this.add)},e.prototype.add=function(){return this.collection.add(new s),this.clean(),this.render()},e.prototype.clean=function(){return this.collection.each(function(t){return t.trigger("clean")})},e.prototype.addFirst=function(){var t;return t=new a({model:this.collection.at(0),className:this.options["class"]}),this.$el.children("div:first").after(t.el)},e.prototype.render=function(){return this.collection.each(function(t){return function(e){var n;return n=new a({model:e,className:t.options["class"]}),t.$el.append(n.el)}}(this))},e.prototype.get=function(){var t;return t=[],this.collection.each(function(e){return t.push(e)}),t},e.prototype.getText=function(){var t;return t=[],this.collection.each(function(e){return t.push(e.get("text"))}),t},e}(Backbone.View),d=new i({add:$("#feedback-add-plus"),el:"#feedback-pluses","class":"feedback_plus",collection:new r}),l=new i({add:$("#feedback-add-minus"),el:"#feedback-minuses","class":"feedback_minus",collection:new r}),$("#add-feedback").click(function(){var t,e,n,o,i,r,s,a,c,u;if(u={},null==y.get())return void y.error();if(u.type=parseInt(y.get()),null==p.get())return void p.error();if(u.make=parseInt(p.get()),null==h.get())return void h.error();if(u.model=parseInt(h.get()),0!==m.get().length&&(u.images=m.get()),t=$("#feedback-header"),""===t.val()?t.blink():u.header=t.val(),1===f.getLength()?$("#feedback-editor").blink():u.content=f.getHTML(),0!==d.get().length){for(a=d.get(),e=0,o=a.length;o>e;e++)if(s=a[e],0===s.get("text").length)return s.trigger("error"),!1;u.pluses=d.getText()}if(0!==l.get().length){for(c=l.get(),n=0,i=c.length;i>n;n++)if(r=c[n],0===r.get("text").length)return r.trigger("error"),!1;u.minuses=l.getText()}return $(this).preload("start"),$.ajax($("body").data("home")+"/api/feedback/create",{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:u}).done(function(t){return function(e){return console.log(e),$(t).preload("stop"),setTimeout(function(){return $.magnificPopup.instance.close(),$.alert("Ваш отзыв об авто добавлен и будет доступен на сайте после проверки.",!0)},1e3),setTimeout(function(){return $(t).preload("reset")},1500)}}(this))})},{"../inc/ImageReader":12,"../inc/SelectView":13,"../inc/Thumbnails":14}],22:[function(t,e,n){t("./search"),t("./sign-up"),t("./feedback"),t("./create-company"),t("./settings")},{"./create-company":20,"./feedback":21,"./search":23,"./settings":24,"./sign-up":25}],23:[function(t,e,n){var o,i,r,s,a,c,u,p,l,h,d;o=t("../inc/SelectView"),$("#search").magnificPopup({type:"inline",closeBtnInside:!0}),p=new o({el:"#search-model",url:"api/get-models-by-make"}),u=new o({el:"#search-make",c:p,url:"api/get-makes-by-type"}),h=new o({el:"#search-type",c:u}),l=$("#search-more"),d=$("#search-year"),autosize(l),r=$("#search-new"),a=$("#search-old"),s=$("#search-new + label"),c=$("#search-old + label"),i=$("#search-button"),i.click(function(){var t;return t={},r.is(":checked")||a.is(":checked")?(r.is(":checked")&&a.is(":checked")?(t["new"]=1,t.old=1):r.is(":checked")?(t["new"]=1,t.old=0):a.is(":checked")&&(t["new"]=0,t.old=1),null==h.get()?void h.error():(t.type=parseInt(h.get()),null==u.get()?void u.error():(t.make=parseInt(u.get()),null==p.get()?void p.error():(t.model=parseInt(p.get()),""===d.val()?void d.blink():(t.year=d.val(),""===l.val()?void l.blink():(t.more=l.val(),$(this).preload("start"),$.ajax($("body").data("home")+"/api/request/create",{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:t}).done(function(t){return function(e){return console.log(e),$(t).preload("stop"),setTimeout(function(){return $.magnificPopup.instance.close(),$.alert("Ваша заявка отправлена! Мы уведомим Вас, как только поступят ответы от компаний.",!0)},1e3)}}(this)))))))):(s.blink(),void c.blink())})},{"../inc/SelectView":13}],24:[function(t,e,n){var o,i,r=function(t,e){return function(){return t.apply(e,arguments)}};$("#profile-settings").magnificPopup({type:"inline",closeBtnInside:!0}),o=function(){function t(){this.change=r(this.change,this),this.email=this.input.val(),this.button.click(this.change)}return t.prototype.input=$("#settings-email"),t.prototype.button=$("#settings-email-button"),t.prototype.home=$("body").data("home"),t.prototype.url="api/settings/email",t.prototype.change=function(){var t;return t=/^([a-z0-9_\.-])+@[a-z0-9-]+\.([a-z]{2,4}\.)?[a-z]{2,4}$/i,this.input.val()===this.email?this.input.blink():t.test(this.input.val())?this.send():this.input.blink()},t.prototype.send=function(){return this.button.preload("start"),$.ajax(this.home+"/"+this.url,{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:{email:this.input.val()}}).done(function(t){return function(e){return t.button.preload("stop"),t.email=t.input.val(),setTimeout(function(){return t.button.preload("reset")},1500)}}(this))},t}(),new o,new(i=function(){function t(){this.change=r(this.change,this),this.button.click(this.change)}return t.prototype.home=$("body").data("home"),t.prototype.url="api/settings/password",t.prototype.current=$("#settings-current-password"),t.prototype["new"]=$("#settings-new-password"),t.prototype.newRepeat=$("#settings-new-repeat"),t.prototype.button=$("#settings-change-password"),t.prototype.change=function(){return""===this.current.val()?void this.current.blink():""===this["new"].val()?void this["new"].blink():""===this.newRepeat.val()||this["new"].val()!==this.newRepeat.val()?void this.newRepeat.blink():this.send()},t.prototype.send=function(){return this.button.preload("start"),$.ajax(this.home+"/"+this.url,{headers:{"X-CSRF-TOKEN":$("body").data("csrf")},method:"POST",data:{current:this.current.val(),"new":this["new"].val(),newRepeat:this.newRepeat.val()}}).done(function(t){return function(e){return console.log(e),"wrong"===e&&(t.button.preload("reset"),t.current.blink()),"ok"===e?(t.button.preload("stop"),t.current.val(""),t["new"].val(""),t.newRepeat.val(""),setTimeout(function(){return t.button.preload("reset")},1500)):void 0}}(this))},t}())},{}],25:[function(t,e,n){var o,i,r,s,a,c;$("#sign-up").magnificPopup({type:"inline",closeBtnInside:!0}),$("#footer-sign-up").magnificPopup({type:"inline",closeBtnInside:!0}),$("#company-signup-button").magnificPopup({type:"inline",closeBtnInside:!0}),$.fn.highlight=function(){return $(this).animate({backgroundColor:"#f3df6d",color:"#fff"},1e3)},s=$("#sign-up-form"),o=$("#sign-up-button"),i=$("#sign-up-check"),s&&(r=s.find('input[name="email"]'),a=s.find('input[name="password"]'),c=function(){var t;if(i.prop("checked")===!0)return t=/^([a-z0-9_\.-])+@[a-z0-9-]+\.([a-z]{2,4}\.)?[a-z]{2,4}$/i,t.test(r.val())?""!==a.val()?s.submit():a.blink():r.blink()},o.click(c),s.keypress(function(t){return 13===t.which?c():void 0}))},{}],26:[function(t,e,n){var o,i,r,s,a,c,u,p,l,h=function(t,e){return function(){return t.apply(e,arguments)}};o=t("./inc/Avatar"),i=t("./inc/FieldSet"),$("#profile-company-pen").magnificPopup({type:"inline",closeBtnInside:!0}),$("#profile-user-pen").magnificPopup({type:"inline",closeBtnInside:!0}),p=new o("#user-ava","#user-ava-file","api/user/avatar"),a=new o("#company-ava","#company-ava-file","api/company/avatar"),l=[{name:"name",value:$.trim($("#profile-user-name").children("span:first").html()),title:"Имя",elToRefresh:$("#profile-user-name").children("span:first")}],c=[{name:"name",value:$.trim($("#profile-company-name").children("span:first").html()),title:"Имя",elToRefresh:$("#profile-company-name").children("span:first")},{name:"address",value:$.trim($("#profile-company-address").html()),title:"Адрес",elToRefresh:$("#profile-company-address")},{name:"phone",value:$.trim($("#profile-company-phone").html()),title:"Телефон",elToRefresh:$("#profile-company-phone")},{name:"about",value:$.trim($("#profile-company-about").html()),title:"О Компании",elToRefresh:$("#profile-company-about")}],u=new i({collection:l,button:$("#edit-user-profile-button"),url:"api/user/edit"}),s=new i({collection:c,button:$("#edit-company-profile-button"),url:"api/company/edit"}),new(r=function(){function t(t){this.showUser=h(this.showUser,this),this.showCompany=h(this.showCompany,this),this.companyBtn.click(this.showCompany),this.userBtn.click(this.showUser),this.userFields=t.user,this.companyFields=t.company}return t.prototype["class"]="profile--hidden",t.prototype.activeClass="profile-info_toogler--active",t.prototype.state="company",t.prototype.companyBtn=$("#profile-show-company"),t.prototype.userBtn=$("#profile-show-user"),t.prototype.showCompany=function(){return"company"!==this.state?(this.changeState(),this.state="company"):void 0},t.prototype.showUser=function(){return"user"!==this.state?(this.changeState(),this.state="user"):void 0},t.prototype.toggleButtons=function(){return"company"===this.state?(this.companyBtn.removeClass(this.activeClass),this.userBtn.addClass(this.activeClass)):(this.userBtn.removeClass(this.activeClass),this.companyBtn.addClass(this.activeClass))},t.prototype.changeState=function(){return this.toggleButtons(),"company"===this.state?(this.hideFields(this.companyFields),this.showFields(this.userFields)):(this.hideFields(this.userFields),this.showFields(this.companyFields))},t.prototype.hideFields=function(t){var e,n,o;o=[];for(n in t)e=t[n],o.push(e.addClass("profile--hidden"));return o},t.prototype.showFields=function(t){var e,n,o;o=[];for(n in t)e=t[n],o.push(e.removeClass("profile--hidden"));return o},t}())({user:{ava:$("#user-ava"),info:$("#profile-user-info")},company:{ava:$("#company-ava"),info:$("#profile-company-info"),tags:$("#profile-company-tags")}})},{"./inc/Avatar":10,"./inc/FieldSet":11}],27:[function(t,e,n){var o,i,r,s,a=function(t,e){function n(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e}(Backbone.Model),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.home=$("body").data("home"),e.prototype.initialize=function(){return this.body=this.$el.find(".requests_body")},e}(Backbone.View),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e}(Backbone.Collection),new(r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.initialize=function(){return this.collection=new s,this.initRequests()},e.prototype.initRequests=function(){return this.$el.children(".requests_item").each(function(t){return function(e,n){var r,s;return r=new o({id:$(n).data("id")}),t.collection.add(r),s=new i({el:n,model:r})}}(this))},e}(Backbone.View))({el:"#user-requests"})},{}]},{},[17]);